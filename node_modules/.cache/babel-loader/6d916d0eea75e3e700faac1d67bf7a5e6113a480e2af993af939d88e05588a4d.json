{"ast":null,"code":"var _dec, _class;\nimport { ANodeView } from \"../nodeView\";\nimport { ASerializable } from \"../../base\";\nimport { Mat3 } from \"../../math\";\nexport let ACameraView = (_dec = ASerializable(\"ACameraView\"), _dec(_class = class ACameraView extends ANodeView {\n  // export class ACameraView extends _ANodeView{\n\n  static Create(model) {\n    let cameraView = new ACameraView();\n    cameraView.setModel(model);\n    return cameraView;\n  }\n  get threeJSCamera() {\n    return this.threejs;\n  }\n  setModelListeners() {\n    super.setModelListeners();\n    const self = this;\n    this.model.addCameraProjectionListener(a => {\n      self.update();\n    });\n  }\n\n  // get threejs():THREE.Camera{\n  //     return this._threejs as THREE.Camera;\n  // }\n\n  get model() {\n    return this._model;\n  }\n  setModel(model) {\n    super.setModel(model);\n    this.update();\n  }\n\n  // setModelListeners(){\n  //     const self=this;\n  //     this.unsubscribe(BASIC_VIEW_SUBSCRIPTIONS.MODEL_STATE_LISTENER, false);\n  //     this.subscribe(this.model.addStateListener(()=>{self.update()}));\n  //     this.unsubscribe(BASIC_VIEW_SUBSCRIPTIONS.MODEL_RELEASE_LISTENER, false);\n  //     this.subscribe(this.model.addEventListener(ANodeModel.Events.RELEASE, ()=>{self.dispose()}));\n  // }\n\n  init() {\n    this.threejs.matrixAutoUpdate = false;\n  }\n\n  // updateTransform() {\n  //     this.update();\n  // }\n\n  setTransform(transform) {\n    if (transform instanceof Mat3) {\n      transform.Mat4From2DH().assignTo(this.threeJSCamera.matrix);\n    } else {\n      transform.getMatrix().assignTo(this.threeJSCamera.matrix);\n    }\n  }\n  update() {\n    // this.model.camera.getProjection().assignTo(this.threejs.projectionMatrix);\n    // this.model.camera.getProjectionInverse().assignTo(this.threejs.projectionMatrixInverse);\n    // this.model.camera.getPose().getMatrix().assignTo(this.threejs.matrix);\n    // this.model.camera.getPose().getMatrix().assignTo(this.threejs.matrixWorld);\n    // this.threejs.matrixWorldInverse.copy( this.threejs.matrixWorld).invert();\n\n    // TODO: Maybe check to make sure this is ok?\n    this.model.camera.getProjection().assignTo(this.threeJSCamera.projectionMatrix);\n    this.model.camera.getProjectionInverse().assignTo(this.threeJSCamera.projectionMatrixInverse);\n    this.model.transform.getMat4().assignTo(this.threeJSCamera.matrix);\n    this.model.transform.getMat4().assignTo(this.threeJSCamera.matrixWorld);\n    this.threeJSCamera.matrixWorldInverse.copy(this.threeJSCamera.matrixWorld).invert();\n  }\n  updateWithCamera(camera) {\n    camera.getProjection().assignTo(this.threeJSCamera.projectionMatrix);\n    camera.getProjectionInverse().assignTo(this.threeJSCamera.projectionMatrixInverse);\n    camera.transform.getMat4().assignTo(this.threeJSCamera.matrix);\n    camera.transform.getMat4().assignTo(this.threeJSCamera.matrixWorld);\n    this.threeJSCamera.matrixWorldInverse.copy(this.threeJSCamera.matrixWorld).invert();\n  }\n  dispose() {}\n  _initializeThreeJSObject() {\n    // super._initializeThreeJSObject();\n    this._threejs = this.model.camera.CreateThreeJSCamera();\n    // this._threeJSCamera = this.model.camera.CreateThreeJSCamera();\n    // this.threejs.add(this.threeJSCamera);\n  }\n}) || _class);","map":{"version":3,"names":["ANodeView","ASerializable","Mat3","ACameraView","_dec","_class","Create","model","cameraView","setModel","threeJSCamera","threejs","setModelListeners","self","addCameraProjectionListener","a","update","_model","init","matrixAutoUpdate","setTransform","transform","Mat4From2DH","assignTo","matrix","getMatrix","camera","getProjection","projectionMatrix","getProjectionInverse","projectionMatrixInverse","getMat4","matrixWorld","matrixWorldInverse","copy","invert","updateWithCamera","dispose","_initializeThreeJSObject","_threejs","CreateThreeJSCamera"],"sources":["/Users/twist/Documents/Books/Fall 2024/Graphics/A1-Intro-To-Graphics-FA2024/src/anigraph/scene/camera/ACameraView.ts"],"sourcesContent":["import {ACameraModel} from \"./index\";\nimport {ANodeView} from \"../nodeView\";\nimport * as THREE from \"three\";\nimport {AObject, ASerializable} from \"../../base\";\nimport {ANodeModel} from \"../nodeModel\";\nimport {ACamera, Mat3, Mat4, TransformationInterface} from \"../../math\";\n\n@ASerializable(\"ACameraView\")\nexport class ACameraView extends ANodeView{\n// export class ACameraView extends _ANodeView{\n\n    static Create(model:ACameraModel){\n        let cameraView = new ACameraView();\n        cameraView.setModel(model);\n        return cameraView;\n    }\n\n    get threeJSCamera():THREE.Camera{\n        return this.threejs as THREE.Camera;\n    }\n\n\n    setModelListeners() {\n        super.setModelListeners();\n        const self = this;\n        this.model.addCameraProjectionListener((a:AObject)=>{\n            self.update();\n        })\n    }\n\n    // get threejs():THREE.Camera{\n    //     return this._threejs as THREE.Camera;\n    // }\n\n    get model():ACameraModel{\n        return this._model as ACameraModel;\n    }\n\n    setModel(model: ACameraModel) {\n        super.setModel(model);\n        this.update();\n    }\n\n    // setModelListeners(){\n    //     const self=this;\n    //     this.unsubscribe(BASIC_VIEW_SUBSCRIPTIONS.MODEL_STATE_LISTENER, false);\n    //     this.subscribe(this.model.addStateListener(()=>{self.update()}));\n    //     this.unsubscribe(BASIC_VIEW_SUBSCRIPTIONS.MODEL_RELEASE_LISTENER, false);\n    //     this.subscribe(this.model.addEventListener(ANodeModel.Events.RELEASE, ()=>{self.dispose()}));\n    // }\n\n    init():void{\n        this.threejs.matrixAutoUpdate=false;\n    }\n\n    // updateTransform() {\n    //     this.update();\n    // }\n\n\n    setTransform(transform:TransformationInterface){\n        if(transform instanceof Mat3){\n            transform.Mat4From2DH().assignTo(this.threeJSCamera.matrix);\n        }else{\n            (transform.getMatrix() as Mat4).assignTo(this.threeJSCamera.matrix);\n        }\n    }\n\n\n    update():void{\n        // this.model.camera.getProjection().assignTo(this.threejs.projectionMatrix);\n        // this.model.camera.getProjectionInverse().assignTo(this.threejs.projectionMatrixInverse);\n        // this.model.camera.getPose().getMatrix().assignTo(this.threejs.matrix);\n        // this.model.camera.getPose().getMatrix().assignTo(this.threejs.matrixWorld);\n        // this.threejs.matrixWorldInverse.copy( this.threejs.matrixWorld).invert();\n\n        // TODO: Maybe check to make sure this is ok?\n        this.model.camera.getProjection().assignTo(this.threeJSCamera.projectionMatrix);\n        this.model.camera.getProjectionInverse().assignTo(this.threeJSCamera.projectionMatrixInverse);\n        this.model.transform.getMat4().assignTo(this.threeJSCamera.matrix);\n        this.model.transform.getMat4().assignTo(this.threeJSCamera.matrixWorld);\n        this.threeJSCamera.matrixWorldInverse.copy( this.threeJSCamera.matrixWorld).invert();\n    }\n\n    updateWithCamera(camera:ACamera){\n        camera.getProjection().assignTo(this.threeJSCamera.projectionMatrix);\n        camera.getProjectionInverse().assignTo(this.threeJSCamera.projectionMatrixInverse);\n        camera.transform.getMat4().assignTo(this.threeJSCamera.matrix);\n        camera.transform.getMat4().assignTo(this.threeJSCamera.matrixWorld);\n        this.threeJSCamera.matrixWorldInverse.copy( this.threeJSCamera.matrixWorld).invert();\n    }\n\n    dispose(): void {\n    }\n\n    protected _initializeThreeJSObject(): void {\n        // super._initializeThreeJSObject();\n        this._threejs = this.model.camera.CreateThreeJSCamera();\n        // this._threeJSCamera = this.model.camera.CreateThreeJSCamera();\n        // this.threejs.add(this.threeJSCamera);\n    }\n\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}
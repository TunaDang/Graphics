{"ast":null,"code":"import _initializerDefineProperty from \"/Users/twist/Documents/Books/Fall 2024/Graphics/A1-Intro-To-Graphics-FA2024/node_modules/@babel/runtime/helpers/esm/initializerDefineProperty.js\";\nimport _applyDecoratedDescriptor from \"/Users/twist/Documents/Books/Fall 2024/Graphics/A1-Intro-To-Graphics-FA2024/node_modules/@babel/runtime/helpers/esm/applyDecoratedDescriptor.js\";\nimport _initializerWarningHelper from \"/Users/twist/Documents/Books/Fall 2024/Graphics/A1-Intro-To-Graphics-FA2024/node_modules/@babel/runtime/helpers/esm/initializerWarningHelper.js\";\nvar _dec, _class, _class2, _descriptor;\nimport { ANodeModel3D } from \"../../nodeModel\";\nimport { AObjectState, ASerializable } from \"../../../base\";\nimport { NodeTransform3D } from \"../../../math\";\nimport { AObject3DModelWrapper } from \"../../../geometry\";\nimport * as THREE from \"three\";\nexport let ALoadedModel = (_dec = ASerializable(\"ALoadedModel\"), _dec(_class = (_class2 = class ALoadedModel extends ANodeModel3D {\n  get sourceScale() {\n    return this.sourceTransform.scale;\n  }\n  set sourceScale(v) {\n    this.sourceTransform.scale = v;\n  }\n  get verts() {\n    return this.geometry.verts;\n  }\n  set verts(v) {\n    this.geometry.verts = v;\n  }\n  static Create(loaded3DModel, material, ...args) {\n    let newmodel = new this(loaded3DModel, material, ...args);\n    return newmodel;\n  }\n  constructor(obj, material, sourceScale = 1) {\n    super();\n    _initializerDefineProperty(this, \"sourceTransform\", _descriptor, this);\n    this.loadedObjects = [];\n    let object = obj;\n    this.sourceTransform = new NodeTransform3D();\n    if (material) {\n      this.setMaterial(material);\n    }\n    if (obj instanceof THREE.BufferGeometry) {\n      if (obj.attributes.normal == undefined) {\n        obj.computeVertexNormals();\n      }\n      let threemesh = new THREE.Mesh(obj, this.material.threejs);\n      object = new AObject3DModelWrapper(threemesh);\n    } else if (obj instanceof THREE.Mesh || obj instanceof THREE.Group) {\n      object = new AObject3DModelWrapper(obj);\n    } else if (obj instanceof AObject3DModelWrapper) {\n      object = obj;\n    } else {\n      throw new Error(`Unrecognized loaded object ${obj} of type ${typeof obj}`);\n    }\n    this.addLoadedObject(object);\n    this.sourceScale = sourceScale;\n    const self = this;\n    this.subscribe(this.addStateKeyListener('sourceTransform', () => {\n      self.geometry.sourceTransform = self.sourceTransform;\n    }), 'loadedmodel.sourceTransform');\n  }\n  addLoadedObject(object) {\n    this.geometry.addMember(object);\n    this.loadedObjects.push(object);\n  }\n}, _descriptor = _applyDecoratedDescriptor(_class2.prototype, \"sourceTransform\", [AObjectState], {\n  configurable: true,\n  enumerable: true,\n  writable: true,\n  initializer: null\n}), _class2)) || _class);","map":{"version":3,"names":["ANodeModel3D","AObjectState","ASerializable","NodeTransform3D","AObject3DModelWrapper","THREE","ALoadedModel","_dec","_class","_class2","sourceScale","sourceTransform","scale","v","verts","geometry","Create","loaded3DModel","material","args","newmodel","constructor","obj","_initializerDefineProperty","_descriptor","loadedObjects","object","setMaterial","BufferGeometry","attributes","normal","undefined","computeVertexNormals","threemesh","Mesh","threejs","Group","Error","addLoadedObject","self","subscribe","addStateKeyListener","addMember","push","_applyDecoratedDescriptor","prototype","configurable","enumerable","writable","initializer"],"sources":["/Users/twist/Documents/Books/Fall 2024/Graphics/A1-Intro-To-Graphics-FA2024/src/anigraph/scene/nodes/loaded/ALoadedModel.ts"],"sourcesContent":["import {ANodeModel3D} from \"../../nodeModel\";\nimport {AObjectState, ASerializable} from \"../../../base\";\nimport {NodeTransform3D, Vec3} from \"../../../math\";\nimport {AObject3DModelWrapper, VertexArray3D} from \"../../../geometry\";\nimport * as THREE from \"three\";\nimport {Loader} from \"three\";\nimport {OBJLoader} from \"three/examples/jsm/loaders/OBJLoader\";\nimport {PLYLoader} from \"three/examples/jsm/loaders/PLYLoader\";\nimport {AMaterial} from \"../../../rendering\";\n\n@ASerializable(\"ALoadedModel\")\nexport class ALoadedModel extends ANodeModel3D{\n    @AObjectState sourceTransform:NodeTransform3D;\n    get sourceScale(){\n        return this.sourceTransform.scale\n    }\n    set sourceScale(v:number|Vec3){\n        this.sourceTransform.scale=v;\n    }\n\n    get verts(){return this.geometry.verts as VertexArray3D;}\n    set verts(v:VertexArray3D){this.geometry.verts = v;}\n    loadedObjects:AObject3DModelWrapper[]=[];\n\n    static Create(loaded3DModel:THREE.Object3D|AObject3DModelWrapper, material?:AMaterial, ...args:any[]){\n        let newmodel = new this(loaded3DModel, material, ...args);\n        return newmodel;\n    }\n\n\n    constructor(obj:THREE.Object3D|AObject3DModelWrapper, material?:AMaterial, sourceScale:number=1) {\n        super();\n        let object = obj;\n        this.sourceTransform = new NodeTransform3D();\n        if(material){\n            this.setMaterial(material);\n        }\n        if(obj instanceof THREE.BufferGeometry) {\n            if(obj.attributes.normal == undefined){\n                obj.computeVertexNormals()\n            }\n            let threemesh = new THREE.Mesh(\n                obj,\n                this.material.threejs\n            );\n            object = new AObject3DModelWrapper(threemesh);\n        }else if(obj instanceof THREE.Mesh || obj instanceof THREE.Group){\n            object = new AObject3DModelWrapper(obj);\n        }else if (obj instanceof AObject3DModelWrapper) {\n            object = obj;\n        }else{\n            throw new Error(`Unrecognized loaded object ${obj} of type ${typeof obj}`);\n        }\n        this.addLoadedObject(object);\n        this.sourceScale=sourceScale;\n        const self = this;\n        this.subscribe(this.addStateKeyListener('sourceTransform', ()=>{\n            self.geometry.sourceTransform = self.sourceTransform;\n        }), 'loadedmodel.sourceTransform');\n    }\n\n    addLoadedObject(object:AObject3DModelWrapper){\n        this.geometry.addMember(object);\n        this.loadedObjects.push(object);\n    }\n\n\n\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}